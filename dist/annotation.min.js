module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t){e.exports=require("openseadragon")},function(e,t,n){e.exports.Dispatcher=n(2)},function(e,t,n){"use strict";t.__esModule=!0;var o=n(3),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||o(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||o(!1);for(var t=0;t<e.length;t++){var n=e[t];this._isPending[n]?this._isHandled[n]||o(!1):(this._callbacks[n]||o(!1),this._invokeCallback(n))}},e.prototype.dispatch=function(e){this._isDispatching&&o(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=r},function(e,t,n){"use strict";var o=function(e){};e.exports=function(e,t,n,r,i,s,a,l){if(o(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,r,i,s,a,l],p=0;(c=new Error(t.replace(/%s/g,function(){return d[p++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,n){var o=n(5);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(9)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){t=e.exports=n(6)(!1);var o=n(7)(n(8));t.push([e.i,"svg polyline,\nsvg polygon,\nsvg line,\nsvg ellipse,\nsvg rect,\nsvg path {\n  stroke-linejoin: round;\n  stroke-linecap: round;\n  vector-effect: non-scaling-stroke;\n  cursor: pointer;\n}\nsvg polyline.active,\nsvg polygon.active,\nsvg line.active,\nsvg ellipse.active,\nsvg rect.active,\nsvg path.active {\n  stroke: #ffff00;\n}\n.icon-close {\n  position: absolute;\n  height: 16px;\n  width: 16px;\n  background-image: url("+o+");\n  background-repeat: no-repeat;\n  background-size: contain;\n  cursor: pointer;\n}\n.start-point,\n.end-point {\n  position: absolute;\n  transform: translate(-50%, -50%);\n  height: 6px;\n  width: 6px;\n  border-radius: 50%;\n}\n.measure-tip {\n  position: absolute;\n  display: inline-block;\n  padding: 0 5px;\n  height: 20px;\n  color: #fff;\n  background-color: #2E2E35;\n  border-radius: 10px;\n  font-size: 9px;\n  font-weight: normal;\n  line-height: 20px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(s=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),i=o.sources.map(function(e){return"/*# sourceURL=".concat(o.sourceRoot).concat(e," */")});return[n].concat(i).concat([r]).join("\n")}var s,a,l;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];null!=i&&(o[i]=!0)}for(var s=0;s<e.length;s++){var a=e[s];null!=a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),t.push(a))}},t}},function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAATlBMVEVHcEz/SET/SET/SEP/SET/SET/RkD/SkP/R0P/R0T/SET/////Skb/wL//xMP/YFz/ZWH/09L/7e3/7u3/wL7/X1z/gH3/ZGH/ZWL/gH5SGK5CAAAACnRSTlMA8fSu7q0oJvOt9NGMTwAAAKVJREFUKM/F09kOwiAQBdCptgUuaxda/f8fNYWoVQZNX3QeCMkJZBYgEkqCDal6ItGiGq0ghWXUbIwLFElUVOsJkgBdDeA3PATv8s75MBQcAGO3jTXApWCP7JsiFuxM8qTGlanNCdIyc5mng3t9Kyx7TvAwPy63HNtnalYfLeylLb7gdd/UlRlJvI8kMiP5x2v5+JCb7RtMFb2i+/aJSHQnHptzTzf2sCZppluhwwAAAABJRU5ErkJggg=="},function(e,t,n){var o,r,i={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=o.apply(this,arguments)),r}),a=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var o=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,n);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}}(),l=null,c=0,d=[],p=n(10);function u(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=i[o.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](o.parts[s]);for(;s<o.parts.length;s++)r.parts.push(g(o.parts[s],t))}else{var a=[];for(s=0;s<o.parts.length;s++)a.push(g(o.parts[s],t));i[o.id]={id:o.id,refs:1,parts:a}}}}function f(e,t){for(var n=[],o={},r=0;r<e.length;r++){var i=e[r],s=t.base?i[0]+t.base:i[0],a={css:i[1],media:i[2],sourceMap:i[3]};o[s]?o[s].parts.push(a):n.push(o[s]={id:s,parts:[a]})}return n}function h(e,t){var n=a(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=d[d.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),d.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=a(e.insertAt.before,n);n.insertBefore(t,r)}}function m(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=d.indexOf(e);t>=0&&d.splice(t,1)}function y(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var o=function(){0;return n.nc}();o&&(e.attrs.nonce=o)}return v(t,e.attrs),h(e,t),t}function v(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function g(e,t){var n,o,r,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var s=c++;n=l||(l=y(t)),o=x.bind(null,n,s,!1),r=x.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),h(e,t),t}(t),o=function(e,t,n){var o=n.css,r=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||i)&&(o=p(o));r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([o],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,n,t),r=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=y(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){m(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return u(n,t),function(e){for(var o=[],r=0;r<n.length;r++){var s=n[r];(a=i[s.id]).refs--,o.push(a)}e&&u(f(e,t),t);for(r=0;r<o.length;r++){var a;if(0===(a=o[r]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete i[a.id]}}}};var k,b=(k=[],function(e,t){return k[e]=t,k.filter(Boolean).join("\n")});function x(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=b(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(r=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(e,t,n){"use strict";n.r(t);var o=n(0),r=function(){},i={},s=[],a=[];function l(e,t){var n,o,l,c,d=a;for(c=arguments.length;c-- >2;)s.push(arguments[c]);for(t&&null!=t.children&&(s.length||s.push(t.children),delete t.children);s.length;)if((o=s.pop())&&void 0!==o.pop)for(c=o.length;c--;)s.push(o[c]);else"boolean"==typeof o&&(o=null),(l="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(l=!1)),l&&n?d[d.length-1]+=o:d===a?d=[o]:d.push(o),n=l;var p=new r;return p.nodeName=e,p.children=d,p.attributes=null==t?void 0:t,p.key=null==t?void 0:t.key,void 0!==i.vnode&&i.vnode(p),p}function c(e,t){for(var n in t)e[n]=t[n];return e}function d(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}var p="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;var u=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,f=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==f.push(e)&&(i.debounceRendering||p)(m)}function m(){for(var e;e=f.pop();)e._dirty&&R(e)}function y(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&v(e,t.nodeName):n||e._componentConstructor===t.nodeName}function v(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function g(e){var t=c({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===t[o]&&(t[o]=n[o]);return t}function k(e){var t=e.parentNode;t&&t.removeChild(e)}function b(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)d(n,null),d(o,e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&!1===u.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var s=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,x,s):e.removeEventListener(t,x,s),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e){try{e[t]=null==o?"":o}catch(e){}null!=o&&!1!==o||"spellcheck"==t||e.removeAttribute(t)}else{var a=r&&t!==(t=t.replace(/^xlink:?/,""));null==o||!1===o?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function x(e){return this._listeners[e.type](i.event&&i.event(e)||e)}var _=[],w=0,M=!1,A=!1;function C(){for(var e;e=_.shift();)i.afterMount&&i.afterMount(e),e.componentDidMount&&e.componentDidMount()}function E(e,t,n,o,r,i){w++||(M=null!=r&&void 0!==r.ownerSVGElement,A=null!=e&&!("__preactattr_"in e));var s=L(e,t,n,o,i);return r&&s.parentNode!==r&&r.appendChild(s),--w||(A=!1,i||C()),s}function L(e,t,n,o,r){var i=e,s=M;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||r)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),S(e,!0))),i.__preactattr_=!0,i;var a,l,c=t.nodeName;if("function"==typeof c)return function(e,t,n,o){var r=e&&e._component,i=r,s=e,a=r&&e._componentConstructor===t.nodeName,l=a,c=g(t);for(;r&&!l&&(r=r._parentComponent);)l=r.constructor===t.nodeName;r&&l&&(!o||r._component)?(O(r,c,3,n,o),e=r.base):(i&&!a&&($(i),e=s=null),r=D(t.nodeName,c,n),e&&!r.nextBase&&(r.nextBase=e,s=null),O(r,c,1,n,o),e=r.base,s&&e!==s&&(s._component=null,S(s,!1)));return e}(e,t,n,o);if(M="svg"===c||"foreignObject"!==c&&M,c=String(c),(!e||!v(e,c))&&(a=c,(l=M?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).normalizedNodeName=a,i=l,e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),S(e,!0)}var d=i.firstChild,p=i.__preactattr_,u=t.children;if(null==p){p=i.__preactattr_={};for(var f=i.attributes,h=f.length;h--;)p[f[h].name]=f[h].value}return!A&&u&&1===u.length&&"string"==typeof u[0]&&null!=d&&void 0!==d.splitText&&null==d.nextSibling?d.nodeValue!=u[0]&&(d.nodeValue=u[0]):(u&&u.length||null!=d)&&function(e,t,n,o,r){var i,s,a,l,c,d=e.childNodes,p=[],u={},f=0,h=0,m=d.length,v=0,g=t?t.length:0;if(0!==m)for(var b=0;b<m;b++){var x=d[b],_=x.__preactattr_,w=g&&_?x._component?x._component.__key:_.key:null;null!=w?(f++,u[w]=x):(_||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(p[v++]=x)}if(0!==g)for(var b=0;b<g;b++){l=t[b],c=null;var w=l.key;if(null!=w)f&&void 0!==u[w]&&(c=u[w],u[w]=void 0,f--);else if(h<v)for(i=h;i<v;i++)if(void 0!==p[i]&&y(s=p[i],l,r)){c=s,p[i]=void 0,i===v-1&&v--,i===h&&h++;break}c=L(c,l,n,o),a=d[b],c&&c!==e&&c!==a&&(null==a?e.appendChild(c):c===a.nextSibling?k(a):e.insertBefore(c,a))}if(f)for(var b in u)void 0!==u[b]&&S(u[b],!1);for(;h<=v;)void 0!==(c=p[v--])&&S(c,!1)}(i,u,n,o,A||null!=p.dangerouslySetInnerHTML),function(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||b(e,o,n[o],n[o]=void 0,M);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||b(e,o,n[o],n[o]=t[o],M)}(i,t.attributes,p),M=s,i}function S(e,t){var n=e._component;n?$(n):(null!=e.__preactattr_&&d(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||k(e),N(e))}function N(e){for(e=e.lastChild;e;){var t=e.previousSibling;S(e,!0),e=t}}var I=[];function D(e,t,n){var o,r=I.length;for(e.prototype&&e.prototype.render?(o=new e(t,n),P.call(o,t,n)):((o=new P(t,n)).constructor=e,o.render=T);r--;)if(I[r].constructor===e)return o.nextBase=I[r].nextBase,I.splice(r,1),o;return o}function T(e,t,n){return this.constructor(e,n)}function O(e,t,n,o,r){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||r?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o)),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&e.base?h(e):R(e,1,r)),d(e.__ref,e))}function R(e,t,n,o){if(!e._disable){var r,s,a,l=e.props,d=e.state,p=e.context,u=e.prevProps||l,f=e.prevState||d,h=e.prevContext||p,m=e.base,y=e.nextBase,v=m||y,k=e._component,b=!1,x=h;if(e.constructor.getDerivedStateFromProps&&(d=c(c({},d),e.constructor.getDerivedStateFromProps(l,d)),e.state=d),m&&(e.props=u,e.state=f,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(l,d,p)?b=!0:e.componentWillUpdate&&e.componentWillUpdate(l,d,p),e.props=l,e.state=d,e.context=p),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!b){r=e.render(l,d,p),e.getChildContext&&(p=c(c({},p),e.getChildContext())),m&&e.getSnapshotBeforeUpdate&&(x=e.getSnapshotBeforeUpdate(u,f));var M,A,L=r&&r.nodeName;if("function"==typeof L){var N=g(r);(s=k)&&s.constructor===L&&N.key==s.__key?O(s,N,1,p,!1):(M=s,e._component=s=D(L,N,p),s.nextBase=s.nextBase||y,s._parentComponent=e,O(s,N,0,p,!1),R(s,1,n,!0)),A=s.base}else a=v,(M=k)&&(a=e._component=null),(v||1===t)&&(a&&(a._component=null),A=E(a,r,p,n||!m,v&&v.parentNode,!0));if(v&&A!==v&&s!==k){var I=v.parentNode;I&&A!==I&&(I.replaceChild(A,v),M||(v._component=null,S(v,!1)))}if(M&&$(M),e.base=A,A&&!o){for(var T=e,P=e;P=P._parentComponent;)(T=P).base=A;A._component=T,A._componentConstructor=T.constructor}}for(!m||n?_.push(e):b||(e.componentDidUpdate&&e.componentDidUpdate(u,f,x),i.afterUpdate&&i.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||o||C()}}function $(e){i.beforeUnmount&&i.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?$(n):t&&(null!=t.__preactattr_&&d(t.__preactattr_.ref,null),e.nextBase=t,k(t),I.push(e),N(t)),d(e.__ref,null)}function P(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function U(e,t,n){return E(n,e,{},!1,t,!1)}c(P.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=c(c({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),h(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),R(this,2)},render:function(){}});function B(e,...t){let n=[];return"annotation"===e?t.forEach(e=>{if(e)for(const t in e)e.hasOwnProperty(t)&&n.push(e[t])}):t.forEach(e=>{if(e)for(const t in e)e.hasOwnProperty(t)&&(n=n.concat(e[t]))}),n=n.sort((e,t)=>Number(e[1].annotationId>t[1].annotationId))}var j=class extends P{constructor(...e){super(...e),this.renderElement=e=>l(...e),this.onMouseDown=e=>{if("MOVE"!==this.state.mode&&0===e.button){e.stopPropagation();const t=this.calculateCoords(e);this.props.dispatch({type:"PRESS",x:t.x,y:t.y}),this.base.style.cursor="pointer"}},this.onMouseUp=e=>{if("MOVE"!==this.state.mode){e.stopPropagation();const t=this.calculateCoords(e);this.props.dispatch({type:"RELEASE",x:t.x,y:t.y})}this.base.style.cursor="default"},this.onMouseMove=e=>{if("MOVE"!==this.state.mode){e.stopPropagation();const t=this.calculateCoords(e);this.props.dispatch({type:"MOVE",x:t.x,y:t.y})}},this.onMouseLeave=e=>{if("MOVE"!==this.state.mode){e.stopPropagation();const t=this.calculateCoords(e);this.props.dispatch({type:"LEAVE_CANVAS",x:t.x,y:t.y})}this.base.style.cursor="default"}}calculateCoords(e){const t=this.base.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;return{x:Math.round(n/t.width*1e4)/100,y:Math.round(o/t.height*1e4)/100}}getInitialState(){return this.props.model}componentDidMount(){this.props.model.addHandler("CHANGE_EVENT",()=>{this.setState(this.props.model)})}render(){let e;return l("div",e=null===window.onpointerdown?{id:"svg_wrapper",width:"100%",height:"100%",style:"",onPointerDown:this.onMouseDown,onPointerUp:this.onMouseUp,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove}:{id:"svg_wrapper",width:"100%",height:"100%",style:"",onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},l("svg",{id:"svg",xmlns:"http://www.w3.org/2000/svg",version:"1.1",preserveAspectRatio:"none",viewBox:"0 0 100 100",width:"100%",height:"100%"},B("annotation",this.state.annotations,this.state.markerLines).map(e=>this.renderElement(e))),B("marker",this.state.markers).map(e=>this.renderElement(e)))}},H=n(1);var V=(e,...t)=>{const n=new H.Dispatcher;return t.forEach(t=>{n.register(t(e))}),e=>n.dispatch(e)};var W=e=>{const t=t=>{t.stopPropagation();const n=t.target.attributes.annotationId.value;e.delMarkersCallback&&e.delMarkersCallback(e.markerLines[n]),delete e.markers[n],delete e.markerLines[n],e.raiseEvent("CHANGE_EVENT")},n=t=>{t.stopPropagation();const n=t.target.attributes.annotationId.value;e.clickAnnotationCallback&&e.clickAnnotationCallback(n)};return o=>{switch(o.type){case"INITIALIZE":e.zoom=o.zoom,e.width=o.width,e.height=o.height;break;case"ZOOM_UPDATE":e.zoom=o.zoom;break;case"MODE_UPDATE":e.drawingId="",e.mode!==o.mode&&(e.mode=o.mode);break;case"ANNOTATIONS_RESET":e.drawingId="",e.annotations=o.annotations||{};break;case"MARKERS_REST":if(e.drawingId="",o.markers)for(const t in o.markers)o.markers.hasOwnProperty(t)&&(e.markers[t]=o.markers[t]);break;case"MARKERLINES_REST":if(e.drawingId="",o.markerLines){e.markerLines=o.markerLines;for(const n in o.markerLines)if(o.markerLines.hasOwnProperty(n))if("line"===o.markerLines[n][0]){if("number"!=typeof(Number(o.markerLines[n][1].x1)+Number(o.markerLines[n][1].y1)+Number(o.markerLines[n][1].x2)+Number(o.markerLines[n][1].y2)))return;let r;e.markers[n]||(e.markers[n]=[]),r=o.markerLines[n][1].x2>=o.markerLines[n][1].x1?"translate(8px, -8px)":"translate(-24px, -8px)",e.markers[n].push(["div",{id:`startPoint_${n}`,annotationId:n,class:"start-point",style:{top:`${o.markerLines[n][1].y1}%`,left:`${o.markerLines[n][1].x1}%`,"background-color":o.markerLines[n][1].stroke||"red"}}]),e.markers[n].push(["div",{id:`endPoint_${n}`,annotationId:n,class:"end-point",style:{top:`${o.markerLines[n][1].y2}%`,left:`${o.markerLines[n][1].x2}%`,"background-color":o.markerLines[n][1].stroke||"red"}}]),e.markers[n].push(["div",{id:`close_${n}`,annotationId:n,class:"icon-close",style:{top:`${o.markerLines[n][1].y2}%`,left:`${o.markerLines[n][1].x2}%`,transform:r},onClick:t,onMouseDown:t}])}else{const r=o.markerLines[n][1].points.split(" ");if(r.length<3)return;e.markers[n]||(e.markers[n]=[]);const i={x:r[0].split(",")[0],y:r[0].split(",")[1]};o.y<=0&&(i.y=2),o.y>=100&&(i.y=98),o.x<=0&&(i.x=2),o.x>=100&&(i.x=98),e.markers[n].push(["div",{id:`close_${n}`,annotationId:n,class:"icon-close",style:{top:`${i.y}%`,left:`${i.x}%`},onClick:t,onMouseDown:t}])}}else e.markerLines={};break;case"PRESS":if("DRAW"===e.mode){e.drawingId=(()=>{let e="";for(let t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!==t&&12!==t&&16!==t&&20!==t||(e+="-");return e})();const t=e.drawingId;switch(e.style.type){case"measureDistance":e.markers[t]=[],e.markers[t].push(["span",{id:`tip_${t}`,annotationId:t,class:"measure-tip",start:{x:o.x,y:o.y},"background-color":e.style.color||"red"},""]),e.markers[t].push(["div",{id:`startPoint_${t}`,annotationId:t,class:"start-point",style:{top:`${o.y}%`,left:`${o.x}%`,"background-color":e.style.color||"red"}}]),e.markers[t].push(["div",{id:`endPoint_${t}`,annotationId:t,class:"end-point",style:{top:`${o.y}%`,left:`${o.x}%`},"background-color":e.style.color||"red"}]),e.markerLines[t]=["line",{id:`meameasureDistance_${t}`,annotationId:t,type:"measureDistance",x1:o.x,y1:o.y,x2:o.x,y2:o.y,stroke:e.style.color||"red","stroke-width":e.style.width||3}];break;case"measureArea":e.markerLines[t]=["polyline",{id:`measureArea_${t}`,annotationId:t,type:"measureArea",points:`${o.x},${o.y}`,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;case"polyline":e.annotations[t]=["polyline",{id:`polyline_${t}`,annotationId:t,points:`${o.x},${o.y}`,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;case"polygon":e.annotations[t]=["polygon",{id:`polygon_${t}`,annotationId:t,points:`${o.x},${o.y}`,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;case"line":e.annotations[t]=["line",{id:`line_${t}`,annotationId:t,x1:o.x,y1:o.y,x2:o.x,y2:o.y,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;case"ellipse":e.annotations[t]=["ellipse",{id:`ellipse_${t}`,annotationId:t,cx:o.x,cy:o.y,rx:0,ry:0,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;case"rect":e.annotations[t]=["rect",{id:`rect_${t}`,annotationId:t,sx:o.x,sy:o.y,x:o.x,y:o.y,width:0,height:0,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}];break;default:e.annotations[t]=["path",{id:`path_${t}`,annotationId:t,d:`M${o.x} ${o.y}`,stroke:e.style.color||"red",fill:e.style.fill||"none","stroke-width":e.style.width||3,onMouseDown:n}]}}break;case"MOVE":if((o.x>0&&o.x<100&&o.y>0||o.y<100)&&"DRAW"===e.mode&&e.drawingId){const t=e.annotations[e.drawingId];if(t)switch(t[0]){case"polyline":case"polygon":t[1].points+=` ${o.x},${o.y}`;break;case"line":t[1].x2=o.x,t[1].y2=o.y;break;case"ellipse":t[1].rx=Math.abs(o.x-t[1].cx),t[1].ry=Math.abs(o.y-t[1].cy);break;case"rect":t[1].x=t[1].sx<o.x?t[1].sx:o.x,t[1].y=t[1].sy<o.y?t[1].sy:o.y,t[1].width=Math.abs(t[1].sx-o.x),t[1].height=Math.abs(t[1].sy-o.y);break;default:t[1].d+=` L${o.x} ${o.y}`}else{const t=e.markers[e.drawingId],n=e.markerLines[e.drawingId];if(t){const r=t[0],i=t[2];n[1].x2=o.x,n[1].y2=o.y,r[1].style=`top: ${(n[1].y1+n[1].y2)/2}%;\n                                      left: ${(n[1].x1+n[1].x2)/2}%;\n                                      background-color: ${r[1]["background-color"]}`;const s=Math.pow(Math.round((o.x-r[1].start.x)*e.imageWidth*.01),2),a=Math.pow(Math.round((o.y-r[1].start.y)*e.imageHeight*.01),2),l=Math.round(Math.sqrt(s+a)*e.pixelRatio);r[2]=`${l}Î¼m`,i[1].style=`top: ${o.y}%;\n                                            left: ${o.x}%;\n                                            background-color: ${i[1]["background-color"]}`}else n[1].points+=` ${o.x},${o.y}`}}break;case"RELEASE":case"LEAVE_CANVAS":if("DRAW"===e.mode&&e.drawingId){const n=e.drawingId,r=e.annotations[n];if(e.drawingId=!1,r)switch(r[0]){case"polyline":case"polygon":case"line":case"ellipse":case"rect":default:e.addAnnotationCallback&&e.addAnnotationCallback(r)}else{const r=e.markers[n],i=e.markerLines[n];if(r)if(r[0][2]){let o;o=i[1].x2>=i[1].x1?"translate(8px, -8px)":"translate(-24px, -8px)",e.markers[n].push(["div",{id:`close_${n}`,annotationId:n,class:"icon-close",style:{top:`${i[1].y2}%`,left:`${i[1].x2}%`,transform:o},onClick:t,onMouseDown:t}]),e.addMarkersCallback&&e.addMarkersCallback(i)}else delete e.markers[n],delete e.markerLines[n];else if(i[1].points.split(" ").length>=3){i[0]="polygon",e.markers[n]=[];const r={x:o.x,y:o.y};o.y<=0&&(r.y=2),o.y>=100&&(r.y=98),o.x<=0&&(r.x=2),o.x>=100&&(r.x=98),e.markers[n].push(["div",{id:`close_${n}`,annotationId:n,class:"icon-close",style:{top:`${r.y}%`,left:`${r.x}%`},onClick:t,onMouseDown:t}]),e.addMarkersCallback&&e.addMarkersCallback(i)}else delete e.annotations[n]}}}e.raiseEvent("CHANGE_EVENT")}};n(4);const z={onOpen(){this.overlay=U(l(j,{dispatch:this.dispatch,model:this.model}),document.body);const e=this.viewer.world.getHomeBounds(),t=this.viewer.viewport.getZoom();this.viewer.addOverlay(this.overlay,new o.Rect(0,0,e.width,e.height,0));const{width:n,height:r}=this.overlay.getBoundingClientRect();this.dispatch({type:"INITIALIZE",zoom:t,width:n,height:r})},getAnnotations(){return this.model.annotations},setAnnotations(e){this.dispatch({type:"ANNOTATIONS_RESET",annotations:e})},cleanAnnotations(){this.dispatch({type:"ANNOTATIONS_RESET"})},getMarkers(){return this.model.markers},setMarkers(e){this.dispatch({type:"MARKERS_REST",markers:e})},getMarkerLines(){return this.model.markerLines},setMarkerLines(e){this.dispatch({type:"MARKERLINES_REST",markerLines:e})},getMode(){return this.model.mode},setMode(e){this.dispatch({type:"MODE_UPDATE",mode:e})},getStatus(){return{active:!!this.overlay}},setStyle(e){e||(e={}),e.type&&(this.model.style.type=e.type),e.color&&(this.model.style.color=e.color),e.width&&(this.model.style.width=e.width),e.fill&&(this.model.style.fill=e.fill)},onStartDraw(e){this.setStyle(e),this.dispatch({type:"MODE_UPDATE",mode:"DRAW"})},onStopDraw(){this.dispatch({type:"MODE_UPDATE",mode:"MOVE"})},setClickAnnotationCallback(e){this.model.clickAnnotationCallback=e},setAddAnnotationCallback(e){this.model.addAnnotationCallback=e},setAddMarkersCallback(e){this.model.addMarkersCallback=e},setDelMarkersCallback(e){this.model.delMarkersCallback=e},cleanMarkers(){this.model.markers={},this.model.markerLines={}},setImageConfig(e,t,n){this.model.imageWidth=e,this.model.imageHeight=t,this.model.pixelRatio=n}};t.default={init:({viewer:e,imageHeight:t,imageWidth:n,pixelRatio:r})=>{const i=(()=>Object.assign(Object.create(o.EventSource.prototype),{events:{},mode:"MOVE",zoom:1,width:0,height:0,imageWidth:0,imageHeight:0,pixelRatio:1,drawingId:"",addAnnotationCallback:null,clickAnnotationCallback:null,addMarkersCallback:null,delMarkersCallback:null,annotations:{},markers:{},markerLines:{},style:{type:"polyline",color:"red",fill:"none",width:3}}))();i.imageHeight=t,i.imageWidth=n,i.pixelRatio=r;const s=V(i,W),a=Object.create(z);return Object.assign(a,{viewer:e,model:i,dispatch:s}),e.addHandler("open",()=>a.onOpen()),e.addHandler("zoom",({zoom:e})=>a.dispatch({type:"ZOOM_UPDATE",zoom:e})),e.isOpen()&&a.onOpen(),a}}}]);